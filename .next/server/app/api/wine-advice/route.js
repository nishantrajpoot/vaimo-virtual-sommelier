"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/wine-advice/route";
exports.ids = ["app/api/wine-advice/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwine-advice%2Froute&page=%2Fapi%2Fwine-advice%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwine-advice%2Froute.ts&appDir=C%3A%5CUsers%5Clamba%5CDownloads%5CRepo%5Cvirtual-sommelier%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Clamba%5CDownloads%5CRepo%5Cvirtual-sommelier&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwine-advice%2Froute&page=%2Fapi%2Fwine-advice%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwine-advice%2Froute.ts&appDir=C%3A%5CUsers%5Clamba%5CDownloads%5CRepo%5Cvirtual-sommelier%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Clamba%5CDownloads%5CRepo%5Cvirtual-sommelier&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_lamba_Downloads_Repo_virtual_sommelier_app_api_wine_advice_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/wine-advice/route.ts */ \"(rsc)/./app/api/wine-advice/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/wine-advice/route\",\n        pathname: \"/api/wine-advice\",\n        filename: \"route\",\n        bundlePath: \"app/api/wine-advice/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\lamba\\\\Downloads\\\\Repo\\\\virtual-sommelier\\\\app\\\\api\\\\wine-advice\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_lamba_Downloads_Repo_virtual_sommelier_app_api_wine_advice_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/wine-advice/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ3aW5lLWFkdmljZSUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGd2luZS1hZHZpY2UlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZ3aW5lLWFkdmljZSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNsYW1iYSU1Q0Rvd25sb2FkcyU1Q1JlcG8lNUN2aXJ0dWFsLXNvbW1lbGllciU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDbGFtYmElNUNEb3dubG9hZHMlNUNSZXBvJTVDdmlydHVhbC1zb21tZWxpZXImaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ3FDO0FBQ2xIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2luZS1zb21tZWxpZXItYWdlbnQvPzVkNTYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxcbGFtYmFcXFxcRG93bmxvYWRzXFxcXFJlcG9cXFxcdmlydHVhbC1zb21tZWxpZXJcXFxcYXBwXFxcXGFwaVxcXFx3aW5lLWFkdmljZVxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvd2luZS1hZHZpY2Uvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS93aW5lLWFkdmljZVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvd2luZS1hZHZpY2Uvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxsYW1iYVxcXFxEb3dubG9hZHNcXFxcUmVwb1xcXFx2aXJ0dWFsLXNvbW1lbGllclxcXFxhcHBcXFxcYXBpXFxcXHdpbmUtYWR2aWNlXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS93aW5lLWFkdmljZS9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwine-advice%2Froute&page=%2Fapi%2Fwine-advice%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwine-advice%2Froute.ts&appDir=C%3A%5CUsers%5Clamba%5CDownloads%5CRepo%5Cvirtual-sommelier%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Clamba%5CDownloads%5CRepo%5Cvirtual-sommelier&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/wine-advice/route.ts":
/*!**************************************!*\
  !*** ./app/api/wine-advice/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var ai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ai */ \"(rsc)/./node_modules/ai/dist/index.mjs\");\n/* harmony import */ var _ai_sdk_openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @ai-sdk/openai */ \"(rsc)/./node_modules/@ai-sdk/openai/dist/index.mjs\");\n// @ts-nocheck\n\n\n\n// Helper to parse price strings like \"13,99 €\" -> 13.99\nfunction parsePrice(priceStr) {\n    const num = priceStr.replace(/[^0-9,.-]/g, \"\").replace(\",\", \".\");\n    return parseFloat(num) || 0;\n}\nasync function POST(request) {\n    try {\n        const { message, language, wines, excludeIds, history } = await request.json();\n        // Initialize candidate set, applying exclusion of already shown IDs and price constraints\n        let candidates = wines;\n        // Exclude previously shown\n        if (Array.isArray(excludeIds) && excludeIds.length > 0) {\n            candidates = candidates.filter((w)=>!excludeIds.includes(w.id));\n        }\n        // Apply price filters if requested\n        const text = message.toLowerCase();\n        let priceMatch;\n        if (priceMatch = text.match(/(?:above|over|greater than)\\s*(\\d+)/i)) {\n            const threshold = parseFloat(priceMatch[1]);\n            candidates = candidates.filter((w)=>parsePrice(w.Price) > threshold);\n        } else if (priceMatch = text.match(/(?:under|less than|below)\\s*(\\d+)/i)) {\n            const threshold = parseFloat(priceMatch[1]);\n            candidates = candidates.filter((w)=>parsePrice(w.Price) < threshold);\n        } else if (/\\b(expensive|premium|high[- ]end|luxury)\\b/i.test(text)) {\n            // Compute 75th percentile price\n            const prices = candidates.map((w)=>parsePrice(w.Price)).sort((a, b)=>a - b);\n            if (prices.length > 0) {\n                const idx = Math.floor(prices.length * 0.75);\n                const threshold = prices[idx];\n                candidates = candidates.filter((w)=>parsePrice(w.Price) >= threshold);\n            }\n        }\n        // 'candidates' already excludes shown IDs and price constraints\n        const dataset = candidates;\n        // Generate AI response with filtered candidate dataset\n        // Include conversation history so AI retains context\n        let systemPrompt = getSystemPrompt(language, dataset);\n        if (Array.isArray(history) && history.length > 0) {\n            const convo = history.map((m)=>`${m.role === \"user\" ? \"User\" : \"Assistant\"}: ${m.content}`).join(\"\\n\");\n            systemPrompt += `\\n\\nConversation history:\\n${convo}`;\n        }\n        let userPrompt = `User query: \"${message}\"\r\n\r\nPlease analyze this query and recommend 3-4 specific wines from the available dataset. Consider:\r\n- Wine preferences (color, type, grape variety)\r\n- Budget constraints \r\n- Food pairings mentioned\r\n- Occasion or context\r\n- Handle typos and variations intelligently (e.g., \"red-wine\" = \"red wine\")\r\n- When recommending wines, take into account the \"food_pairing\", \"color\", \"type\", \"grape_variety\", \"price\", \"volume\", \"promotion\", \"country_origin\", \"Vegetarian\", \"Vegan\" fields of the dataset\r\n- In the context of food pairings suggestions, take into account the \"food_pairing\" field of the dataset\r\n\r\nRespond with wine advice and explain your recommendations.`;\n        // Instruct AI to exclude already recommended wines\n        if (Array.isArray(excludeIds) && excludeIds.length > 0) {\n            userPrompt += `\\n\\nExclude these wine IDs from recommendations: ${JSON.stringify(excludeIds)}`;\n        }\n        try {\n            // Check if API key is available\n            if (false) {}\n            const { text } = await (0,ai__WEBPACK_IMPORTED_MODULE_1__.generateText)({\n                // Use high-performance GPT-4 model\n                model: (0,_ai_sdk_openai__WEBPACK_IMPORTED_MODULE_2__.openai)(\"gpt-4o\"),\n                system: systemPrompt,\n                prompt: userPrompt,\n                maxTokens: 500\n            });\n            // Extract wine recommendations from GPT response\n            const recommendations = extractRecommendationsFromResponse(text, dataset);\n            const recs = recommendations.length > 0 ? recommendations : getSimpleFallback(message, dataset);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                message: text,\n                recommendations: recs\n            });\n        } catch (error) {\n            console.error(\"AI service error:\", error);\n            // Fallback to non-AI response if API fails\n            const fallbackRecs = getSimpleFallback(message, wines);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                message: generateFallbackResponse(message, wines, language),\n                recommendations: fallbackRecs\n            });\n        }\n    } catch (error) {\n        console.error(\"API route error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n/**\r\n * Simple fallback: pick wines based on basic keyword match in message\r\n */ function getSimpleFallback(message, wines) {\n    const lower = message.toLowerCase();\n    let filtered = [];\n    if (lower.includes(\"red\")) {\n        filtered = wines.filter((w)=>w.Color?.toLowerCase() === \"red\");\n    } else if (lower.includes(\"white\")) {\n        filtered = wines.filter((w)=>w.Color?.toLowerCase() === \"white\");\n    } else if (lower.includes(\"ros\") || lower.includes(\"rose\")) {\n        filtered = wines.filter((w)=>w.Color?.toLowerCase() === \"rose\");\n    } else if (lower.includes(\"sparkling\") || lower.includes(\"bubbl\")) {\n        filtered = wines.filter((w)=>w.Color?.toLowerCase() === \"sparkling\");\n    }\n    if (filtered.length >= 3) {\n        return filtered.slice(0, 3);\n    }\n    // default first 3\n    return wines.slice(0, 3);\n}\n/**\r\n * Extract up to 4 wine recommendations by matching their UUIDs in the AI response.\r\n */ function extractRecommendationsFromResponse(response, wines) {\n    // 1) Try to parse explicit ID list\n    const idSection = response.match(/RECOMMENDED_IDS:?\\s*\\[([^\\]]+)\\]/i);\n    if (idSection) {\n        const ids = idSection[1].split(/[,\\s]+/).map((s)=>s.replace(/\"/g, \"\").trim()).filter((s)=>s);\n        const found = wines.filter((wine)=>ids.includes(wine.id));\n        if (found.length > 0) {\n            return found.slice(0, 4);\n        }\n    }\n    // 2) Fallback to name-based matching if no IDs found\n    const recsByName = [];\n    const responseText = response.toLowerCase();\n    for (const wine of wines){\n        if (recsByName.length >= 4) break;\n        if (wine.Product_name && responseText.includes(wine.Product_name.toLowerCase())) {\n            recsByName.push(wine);\n        }\n    }\n    if (recsByName.length > 0) {\n        return recsByName;\n    }\n    // 3) Fallback to category-based selection\n    return getIntelligentFallback(wines);\n}\nfunction getSystemPrompt(language, wines) {\n    // Provide a limited wine dataset sample as context (reduce token size)\n    const wineDataSample = wines.slice(0, 20).map((wine)=>({\n            id: wine.id,\n            name: wine.Product_name,\n            price: wine.Price,\n            volume: wine.Volume,\n            discount: wine.promotion,\n            link: wine.URL\n        }));\n    const prompts = {\n        en: `You are a professional wine sommelier for Delhaize with access to their complete wine inventory.\r\n\r\nWINE DATASET SAMPLE:\r\n${JSON.stringify(wineDataSample, null, 2)}\r\n\r\nYour capabilities:\r\n- Intelligently interpret user queries, including typos and variations\r\n- Handle queries like \"red-wine\", \"red wine\", \"rouge vin\", etc. as the same request\r\n- Recommend specific wines from the Delhaize inventory\r\n   - Provide expert wine advice and food pairings\r\n   - When the user mentions price constraints (e.g., \"expensive\", \"under 20\"), parse the Price field (e.g., \"13,99 €\") into a numeric value and filter accordingly\r\n   - Consider budget, occasion, and preferences, using the Price field as numeric\r\n\r\nGuidelines:\r\n- Always recommend 3-4 specific wines from the available inventory\r\n- Mention exact wine names from the dataset\r\n- Explain why each wine fits the user's request\r\n- Handle spelling variations and typos gracefully\r\n- Consider price ranges, wine types, and occasions\r\n- Provide food pairing suggestions when relevant\r\n- Be enthusiastic but professional   \r\n`,\n        fr: `Vous êtes un sommelier professionnel pour Delhaize avec accès à leur inventaire complet de vins.\r\n\r\nÉCHANTILLON DE DONNÉES VINS:\r\n${JSON.stringify(wineDataSample, null, 2)}\r\n\r\nVos capacités:\r\n- Interpréter intelligemment les requêtes utilisateur, y compris les fautes de frappe et variations\r\n- Gérer les requêtes comme \"vin-rouge\", \"vin rouge\", \"red wine\", etc. comme la même demande\r\n- Recommander des vins spécifiques de l'inventaire Delhaize\r\n- Fournir des conseils d'expert et accords mets-vins\r\n- Considérer le budget, l'occasion, et les préférences\r\n\r\nDirectives:\r\n- Recommandez toujours 3-4 vins spécifiques de l'inventaire disponible\r\n- Mentionnez les noms exacts des vins du dataset\r\n- Expliquez pourquoi chaque vin correspond à la demande\r\n- Gérez les variations d'orthographe et fautes de frappe avec souplesse\r\n- Considérez les gammes de prix, types de vins, et occasions\r\n- Fournissez des suggestions d'accords mets-vins quand pertinent\r\n- Soyez enthousiaste mais professionnel`,\n        nl: `U bent een professionele wijn sommelier voor Delhaize met toegang tot hun complete wijnvoorraad.\r\n\r\nWIJN DATASET VOORBEELD:\r\n${JSON.stringify(wineDataSample, null, 2)}\r\n\r\nUw mogelijkheden:\r\n- Intelligent interpreteren van gebruikersverzoeken, inclusief typefouten en variaties\r\n- Verzoeken zoals \"rode-wijn\", \"rode wijn\", \"red wine\", etc. als hetzelfde verzoek behandelen\r\n- Specifieke wijnen aanbevelen uit de Delhaize voorraad\r\n- Deskundig wijnadvies en spijs-wijn combinaties geven\r\n- Budget, gelegenheid en voorkeuren overwegen\r\n\r\nRichtlijnen:\r\n- Beveel altijd 3-4 specifieke wijnen aan uit de beschikbare voorraad\r\n- Noem exacte wijnnamen uit de dataset\r\n- Leg uit waarom elke wijn past bij het verzoek\r\n- Behandel spellingsvariaties en typefouten soepel\r\n- Overweeg prijsklassen, wijntypes en gelegenheden\r\n- Geef spijs-wijn combinatie suggesties wanneer relevant\r\n- Wees enthousiast maar professioneel`\n    };\n    return prompts[language];\n}\nfunction getIntelligentFallback(wines) {\n    // Return a diverse selection across different categories and price points\n    const categories = {\n        red: wines.filter((w)=>w.Product_name.toLowerCase().includes(\"rouge\") || w.Product_name.toLowerCase().includes(\"red\") || w.Product_name.toLowerCase().includes(\"merlot\") || w.Product_name.toLowerCase().includes(\"cabernet\") || w.Product_name.toLowerCase().includes(\"syrah\")),\n        white: wines.filter((w)=>w.Product_name.toLowerCase().includes(\"blanc\") || w.Product_name.toLowerCase().includes(\"white\") || w.Product_name.toLowerCase().includes(\"chardonnay\") || w.Product_name.toLowerCase().includes(\"sauvignon\")),\n        sparkling: wines.filter((w)=>w.Product_name.toLowerCase().includes(\"champagne\") || w.Product_name.toLowerCase().includes(\"mousseux\") || w.Product_name.toLowerCase().includes(\"brut\")),\n        rose: wines.filter((w)=>w.Product_name.toLowerCase().includes(\"ros\\xe9\") || w.Product_name.toLowerCase().includes(\"rose\") || w.Product_name.toLowerCase().includes(\"gris\"))\n    };\n    const recommendations = [];\n    // Add one from each category if available\n    if (categories.red.length > 0) recommendations.push(categories.red[0]);\n    if (categories.white.length > 0) recommendations.push(categories.white[0]);\n    if (categories.sparkling.length > 0) recommendations.push(categories.sparkling[0]);\n    if (categories.rose.length > 0) recommendations.push(categories.rose[0]);\n    // Fill remaining slots with diverse price points\n    while(recommendations.length < 4 && recommendations.length < wines.length){\n        const remaining = wines.filter((w)=>!recommendations.includes(w));\n        if (remaining.length > 0) {\n            recommendations.push(remaining[0]);\n        } else {\n            break;\n        }\n    }\n    return recommendations.slice(0, 4);\n}\nfunction getAskForPreferencesMessage(language) {\n    const messages = {\n        en: \"I'd be happy to help you find the perfect wine! To give you the best recommendations, could you tell me:\\n\\n• What color wine do you prefer? (Red, White, Ros\\xe9, or Sparkling)\\n• What's your budget range? (Budget: €0-10, Mid-range: €10-25, Premium: €25-50, Luxury: €50+)\\n• What's the occasion or what food will you be pairing it with?\",\n        fr: \"Je serais ravi de vous aider \\xe0 trouver le vin parfait ! Pour vous donner les meilleures recommandations, pourriez-vous me dire :\\n\\n• Quelle couleur de vin pr\\xe9f\\xe9rez-vous ? (Rouge, Blanc, Ros\\xe9, ou Effervescent)\\n• Quelle est votre gamme de budget ? (\\xc9conomique : €0-10, Milieu de gamme : €10-25, Premium : €25-50, Luxe : €50+)\\n• Quelle est l'occasion ou avec quels plats l'accompagnerez-vous ?\",\n        nl: \"Ik help u graag de perfecte wijn te vinden! Om u de beste aanbevelingen te geven, kunt u me vertellen:\\n\\n• Welke wijnkleur heeft uw voorkeur? (Rood, Wit, Ros\\xe9, of Mousserende)\\n• Wat is uw budgetbereik? (Budget: €0-10, Middensegment: €10-25, Premium: €25-50, Luxe: €50+)\\n• Wat is de gelegenheid of bij welk eten wilt u de wijn combineren?\"\n    };\n    return messages[language];\n}\nfunction generateFallbackResponse(message, wines, language) {\n    const responses = {\n        en: \"Based on your preferences, here are some excellent wine options from our Delhaize selection. These wines would be perfect for your needs!\",\n        fr: \"Bas\\xe9 sur vos pr\\xe9f\\xe9rences, voici d'excellentes options de vin de notre s\\xe9lection Delhaize. Ces vins seraient parfaits pour vos besoins !\",\n        nl: \"Op basis van uw voorkeuren zijn hier enkele uitstekende wijnopties uit onze Delhaize selectie. Deze wijnen zouden perfect zijn voor uw behoeften!\"\n    };\n    return responses[language];\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUEsU0FBUzhDLHlCQUF5Qi9DLE9BQWUsRUFBRUUsS0FBYSxFQUFFRCxRQUFrQjtJQUNsRixNQUFNOEYsWUFBWTtRQUNoQlgsSUFBSTtRQUNKQyxJQUFJO1FBQ0pDLElBQUk7SUFDTjtJQUVBLE9BQU9TLFNBQVMsQ0FBQzlGLFNBQVM7QUFDNUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93aW5lLXNvbW1lbGllci1hZ2VudC8uL2FwcC9hcGkvd2luZS1hZHZpY2Uvcm91dGUudHM/ZjNhOCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAdHMtbm9jaGVja1xyXG5pbXBvcnQgeyB0eXBlIE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIlxyXG5pbXBvcnQgeyBnZW5lcmF0ZVRleHQgfSBmcm9tIFwiYWlcIlxyXG5pbXBvcnQgeyBvcGVuYWkgfSBmcm9tIFwiQGFpLXNkay9vcGVuYWlcIlxyXG5pbXBvcnQgdHlwZSB7IExhbmd1YWdlLCBXaW5lIH0gZnJvbSBcIkAvdHlwZXMvd2luZVwiXHJcblxyXG4vLyBIZWxwZXIgdG8gcGFyc2UgcHJpY2Ugc3RyaW5ncyBsaWtlIFwiMTMsOTkg4oKsXCIgLT4gMTMuOTlcclxuZnVuY3Rpb24gcGFyc2VQcmljZShwcmljZVN0cjogc3RyaW5nKTogbnVtYmVyIHtcclxuICBjb25zdCBudW0gPSBwcmljZVN0ci5yZXBsYWNlKC9bXjAtOSwuLV0vZywgJycpLnJlcGxhY2UoJywnLCAnLicpXHJcbiAgcmV0dXJuIHBhcnNlRmxvYXQobnVtKSB8fCAwXHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgbWVzc2FnZSwgbGFuZ3VhZ2UsIHdpbmVzLCBleGNsdWRlSWRzLCBoaXN0b3J5IH0gPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxyXG4gICAgLy8gSW5pdGlhbGl6ZSBjYW5kaWRhdGUgc2V0LCBhcHBseWluZyBleGNsdXNpb24gb2YgYWxyZWFkeSBzaG93biBJRHMgYW5kIHByaWNlIGNvbnN0cmFpbnRzXHJcbiAgICBsZXQgY2FuZGlkYXRlczogV2luZVtdID0gd2luZXNcclxuICAgIC8vIEV4Y2x1ZGUgcHJldmlvdXNseSBzaG93blxyXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoZXhjbHVkZUlkcykgJiYgZXhjbHVkZUlkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGNhbmRpZGF0ZXMgPSBjYW5kaWRhdGVzLmZpbHRlcigodykgPT4gIWV4Y2x1ZGVJZHMuaW5jbHVkZXMody5pZCkpXHJcbiAgICB9XHJcbiAgICAvLyBBcHBseSBwcmljZSBmaWx0ZXJzIGlmIHJlcXVlc3RlZFxyXG4gICAgY29uc3QgdGV4dCA9IG1lc3NhZ2UudG9Mb3dlckNhc2UoKVxyXG4gICAgbGV0IHByaWNlTWF0Y2hcclxuICAgIGlmICgocHJpY2VNYXRjaCA9IHRleHQubWF0Y2goLyg/OmFib3ZlfG92ZXJ8Z3JlYXRlciB0aGFuKVxccyooXFxkKykvaSkpKSB7XHJcbiAgICAgIGNvbnN0IHRocmVzaG9sZCA9IHBhcnNlRmxvYXQocHJpY2VNYXRjaFsxXSlcclxuICAgICAgY2FuZGlkYXRlcyA9IGNhbmRpZGF0ZXMuZmlsdGVyKCh3KSA9PiBwYXJzZVByaWNlKHcuUHJpY2UpID4gdGhyZXNob2xkKVxyXG4gICAgfSBlbHNlIGlmICgocHJpY2VNYXRjaCA9IHRleHQubWF0Y2goLyg/OnVuZGVyfGxlc3MgdGhhbnxiZWxvdylcXHMqKFxcZCspL2kpKSkge1xyXG4gICAgICBjb25zdCB0aHJlc2hvbGQgPSBwYXJzZUZsb2F0KHByaWNlTWF0Y2hbMV0pXHJcbiAgICAgIGNhbmRpZGF0ZXMgPSBjYW5kaWRhdGVzLmZpbHRlcigodykgPT4gcGFyc2VQcmljZSh3LlByaWNlKSA8IHRocmVzaG9sZClcclxuICAgIH1cclxuICAgIC8vIEludGVycHJldCBnZW5lcmljICdleHBlbnNpdmUnIG9yICdwcmVtaXVtJ1xyXG4gICAgZWxzZSBpZiAoL1xcYihleHBlbnNpdmV8cHJlbWl1bXxoaWdoWy0gXWVuZHxsdXh1cnkpXFxiL2kudGVzdCh0ZXh0KSkge1xyXG4gICAgICAvLyBDb21wdXRlIDc1dGggcGVyY2VudGlsZSBwcmljZVxyXG4gICAgICBjb25zdCBwcmljZXMgPSBjYW5kaWRhdGVzLm1hcCgodykgPT4gcGFyc2VQcmljZSh3LlByaWNlKSkuc29ydCgoYSwgYikgPT4gYSAtIGIpXHJcbiAgICAgIGlmIChwcmljZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGNvbnN0IGlkeCA9IE1hdGguZmxvb3IocHJpY2VzLmxlbmd0aCAqIDAuNzUpXHJcbiAgICAgICAgY29uc3QgdGhyZXNob2xkID0gcHJpY2VzW2lkeF1cclxuICAgICAgICBjYW5kaWRhdGVzID0gY2FuZGlkYXRlcy5maWx0ZXIoKHcpID0+IHBhcnNlUHJpY2Uody5QcmljZSkgPj0gdGhyZXNob2xkKVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyAnY2FuZGlkYXRlcycgYWxyZWFkeSBleGNsdWRlcyBzaG93biBJRHMgYW5kIHByaWNlIGNvbnN0cmFpbnRzXHJcbiAgICBjb25zdCBkYXRhc2V0ID0gY2FuZGlkYXRlc1xyXG5cclxuICAgIC8vIEdlbmVyYXRlIEFJIHJlc3BvbnNlIHdpdGggZmlsdGVyZWQgY2FuZGlkYXRlIGRhdGFzZXRcclxuICAgIC8vIEluY2x1ZGUgY29udmVyc2F0aW9uIGhpc3Rvcnkgc28gQUkgcmV0YWlucyBjb250ZXh0XHJcbiAgICBsZXQgc3lzdGVtUHJvbXB0ID0gZ2V0U3lzdGVtUHJvbXB0KGxhbmd1YWdlLCBkYXRhc2V0KVxyXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoaGlzdG9yeSkgJiYgaGlzdG9yeS5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGNvbnN0IGNvbnZvID0gaGlzdG9yeVxyXG4gICAgICAgIC5tYXAoKG06IGFueSkgPT4gYCR7bS5yb2xlID09PSAndXNlcicgPyAnVXNlcicgOiAnQXNzaXN0YW50J306ICR7bS5jb250ZW50fWApXHJcbiAgICAgICAgLmpvaW4oXCJcXG5cIilcclxuICAgICAgc3lzdGVtUHJvbXB0ICs9IGBcXG5cXG5Db252ZXJzYXRpb24gaGlzdG9yeTpcXG4ke2NvbnZvfWBcclxuICAgIH1cclxuICAgIGxldCB1c2VyUHJvbXB0ID0gYFVzZXIgcXVlcnk6IFwiJHttZXNzYWdlfVwiXHJcblxyXG5QbGVhc2UgYW5hbHl6ZSB0aGlzIHF1ZXJ5IGFuZCByZWNvbW1lbmQgMy00IHNwZWNpZmljIHdpbmVzIGZyb20gdGhlIGF2YWlsYWJsZSBkYXRhc2V0LiBDb25zaWRlcjpcclxuLSBXaW5lIHByZWZlcmVuY2VzIChjb2xvciwgdHlwZSwgZ3JhcGUgdmFyaWV0eSlcclxuLSBCdWRnZXQgY29uc3RyYWludHMgXHJcbi0gRm9vZCBwYWlyaW5ncyBtZW50aW9uZWRcclxuLSBPY2Nhc2lvbiBvciBjb250ZXh0XHJcbi0gSGFuZGxlIHR5cG9zIGFuZCB2YXJpYXRpb25zIGludGVsbGlnZW50bHkgKGUuZy4sIFwicmVkLXdpbmVcIiA9IFwicmVkIHdpbmVcIilcclxuLSBXaGVuIHJlY29tbWVuZGluZyB3aW5lcywgdGFrZSBpbnRvIGFjY291bnQgdGhlIFwiZm9vZF9wYWlyaW5nXCIsIFwiY29sb3JcIiwgXCJ0eXBlXCIsIFwiZ3JhcGVfdmFyaWV0eVwiLCBcInByaWNlXCIsIFwidm9sdW1lXCIsIFwicHJvbW90aW9uXCIsIFwiY291bnRyeV9vcmlnaW5cIiwgXCJWZWdldGFyaWFuXCIsIFwiVmVnYW5cIiBmaWVsZHMgb2YgdGhlIGRhdGFzZXRcclxuLSBJbiB0aGUgY29udGV4dCBvZiBmb29kIHBhaXJpbmdzIHN1Z2dlc3Rpb25zLCB0YWtlIGludG8gYWNjb3VudCB0aGUgXCJmb29kX3BhaXJpbmdcIiBmaWVsZCBvZiB0aGUgZGF0YXNldFxyXG5cclxuUmVzcG9uZCB3aXRoIHdpbmUgYWR2aWNlIGFuZCBleHBsYWluIHlvdXIgcmVjb21tZW5kYXRpb25zLmBcclxuICAgIC8vIEluc3RydWN0IEFJIHRvIGV4Y2x1ZGUgYWxyZWFkeSByZWNvbW1lbmRlZCB3aW5lc1xyXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoZXhjbHVkZUlkcykgJiYgZXhjbHVkZUlkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHVzZXJQcm9tcHQgKz0gYFxcblxcbkV4Y2x1ZGUgdGhlc2Ugd2luZSBJRHMgZnJvbSByZWNvbW1lbmRhdGlvbnM6ICR7SlNPTi5zdHJpbmdpZnkoZXhjbHVkZUlkcyl9YFxyXG4gICAgfVxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIENoZWNrIGlmIEFQSSBrZXkgaXMgYXZhaWxhYmxlXHJcbiAgICAgIGlmICghcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVkpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oXCJPcGVuQUkgQVBJIGtleSBub3QgZm91bmQsIHVzaW5nIGZhbGxiYWNrIHJlc3BvbnNlXCIpXHJcbiAgICAgICAgY29uc3QgZmFsbGJhY2tSZWNzID0gZ2V0U2ltcGxlRmFsbGJhY2sobWVzc2FnZSwgd2luZXMpXHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgICAgIG1lc3NhZ2U6IGdlbmVyYXRlRmFsbGJhY2tSZXNwb25zZShtZXNzYWdlLCB3aW5lcywgbGFuZ3VhZ2UpLFxyXG4gICAgICAgICAgcmVjb21tZW5kYXRpb25zOiBmYWxsYmFja1JlY3MsXHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgeyB0ZXh0IH0gPSBhd2FpdCBnZW5lcmF0ZVRleHQoe1xyXG4gICAgICAgIC8vIFVzZSBoaWdoLXBlcmZvcm1hbmNlIEdQVC00IG1vZGVsXHJcbiAgICAgICAgbW9kZWw6IG9wZW5haShcImdwdC00b1wiKSxcclxuICAgICAgICBzeXN0ZW06IHN5c3RlbVByb21wdCxcclxuICAgICAgICBwcm9tcHQ6IHVzZXJQcm9tcHQsXHJcbiAgICAgICAgbWF4VG9rZW5zOiA1MDAsXHJcbiAgICAgIH0pXHJcblxyXG4gICAgICAvLyBFeHRyYWN0IHdpbmUgcmVjb21tZW5kYXRpb25zIGZyb20gR1BUIHJlc3BvbnNlXHJcbiAgICAgIGNvbnN0IHJlY29tbWVuZGF0aW9ucyA9IGV4dHJhY3RSZWNvbW1lbmRhdGlvbnNGcm9tUmVzcG9uc2UodGV4dCwgZGF0YXNldClcclxuICAgICAgY29uc3QgcmVjcyA9IHJlY29tbWVuZGF0aW9ucy5sZW5ndGggPiAwID8gcmVjb21tZW5kYXRpb25zIDogZ2V0U2ltcGxlRmFsbGJhY2sobWVzc2FnZSwgZGF0YXNldClcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgICBtZXNzYWdlOiB0ZXh0LFxyXG4gICAgICAgIHJlY29tbWVuZGF0aW9uczogcmVjcyxcclxuICAgICAgfSlcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJBSSBzZXJ2aWNlIGVycm9yOlwiLCBlcnJvcilcclxuICAgICAgLy8gRmFsbGJhY2sgdG8gbm9uLUFJIHJlc3BvbnNlIGlmIEFQSSBmYWlsc1xyXG4gICAgICBjb25zdCBmYWxsYmFja1JlY3MgPSBnZXRTaW1wbGVGYWxsYmFjayhtZXNzYWdlLCB3aW5lcylcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgICBtZXNzYWdlOiBnZW5lcmF0ZUZhbGxiYWNrUmVzcG9uc2UobWVzc2FnZSwgd2luZXMsIGxhbmd1YWdlKSxcclxuICAgICAgICByZWNvbW1lbmRhdGlvbnM6IGZhbGxiYWNrUmVjcyxcclxuICAgICAgfSlcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkFQSSByb3V0ZSBlcnJvcjpcIiwgZXJyb3IpXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJJbnRlcm5hbCBzZXJ2ZXIgZXJyb3JcIiB9LCB7IHN0YXR1czogNTAwIH0pXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogU2ltcGxlIGZhbGxiYWNrOiBwaWNrIHdpbmVzIGJhc2VkIG9uIGJhc2ljIGtleXdvcmQgbWF0Y2ggaW4gbWVzc2FnZVxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0U2ltcGxlRmFsbGJhY2sobWVzc2FnZTogc3RyaW5nLCB3aW5lczogV2luZVtdKTogV2luZVtdIHtcclxuICBjb25zdCBsb3dlciA9IG1lc3NhZ2UudG9Mb3dlckNhc2UoKVxyXG4gIGxldCBmaWx0ZXJlZDogV2luZVtdID0gW11cclxuICBpZiAobG93ZXIuaW5jbHVkZXMoXCJyZWRcIikpIHtcclxuICAgIGZpbHRlcmVkID0gd2luZXMuZmlsdGVyKCh3KSA9PiB3LkNvbG9yPy50b0xvd2VyQ2FzZSgpID09PSBcInJlZFwiKVxyXG4gIH0gZWxzZSBpZiAobG93ZXIuaW5jbHVkZXMoXCJ3aGl0ZVwiKSkge1xyXG4gICAgZmlsdGVyZWQgPSB3aW5lcy5maWx0ZXIoKHcpID0+IHcuQ29sb3I/LnRvTG93ZXJDYXNlKCkgPT09IFwid2hpdGVcIilcclxuICB9IGVsc2UgaWYgKGxvd2VyLmluY2x1ZGVzKFwicm9zXCIpIHx8IGxvd2VyLmluY2x1ZGVzKFwicm9zZVwiKSkge1xyXG4gICAgZmlsdGVyZWQgPSB3aW5lcy5maWx0ZXIoKHcpID0+IHcuQ29sb3I/LnRvTG93ZXJDYXNlKCkgPT09IFwicm9zZVwiKVxyXG4gIH0gZWxzZSBpZiAobG93ZXIuaW5jbHVkZXMoXCJzcGFya2xpbmdcIikgfHwgbG93ZXIuaW5jbHVkZXMoXCJidWJibFwiKSkge1xyXG4gICAgZmlsdGVyZWQgPSB3aW5lcy5maWx0ZXIoKHcpID0+IHcuQ29sb3I/LnRvTG93ZXJDYXNlKCkgPT09IFwic3BhcmtsaW5nXCIpXHJcbiAgfVxyXG4gIGlmIChmaWx0ZXJlZC5sZW5ndGggPj0gMykge1xyXG4gICAgcmV0dXJuIGZpbHRlcmVkLnNsaWNlKDAsIDMpXHJcbiAgfVxyXG4gIC8vIGRlZmF1bHQgZmlyc3QgM1xyXG4gIHJldHVybiB3aW5lcy5zbGljZSgwLCAzKVxyXG59XHJcblxyXG4vKipcclxuICogRXh0cmFjdCB1cCB0byA0IHdpbmUgcmVjb21tZW5kYXRpb25zIGJ5IG1hdGNoaW5nIHRoZWlyIFVVSURzIGluIHRoZSBBSSByZXNwb25zZS5cclxuICovXHJcbmZ1bmN0aW9uIGV4dHJhY3RSZWNvbW1lbmRhdGlvbnNGcm9tUmVzcG9uc2UocmVzcG9uc2U6IHN0cmluZywgd2luZXM6IFdpbmVbXSk6IFdpbmVbXSB7XHJcbiAgLy8gMSkgVHJ5IHRvIHBhcnNlIGV4cGxpY2l0IElEIGxpc3RcclxuICBjb25zdCBpZFNlY3Rpb24gPSByZXNwb25zZS5tYXRjaCgvUkVDT01NRU5ERURfSURTOj9cXHMqXFxbKFteXFxdXSspXFxdL2kpXHJcbiAgaWYgKGlkU2VjdGlvbikgeyAgICBcclxuICAgIGNvbnN0IGlkcyA9IGlkU2VjdGlvblsxXVxyXG4gICAgICAuc3BsaXQoL1ssXFxzXSsvKVxyXG4gICAgICAubWFwKChzKSA9PiBzLnJlcGxhY2UoL1wiL2csIFwiXCIpLnRyaW0oKSlcclxuICAgICAgLmZpbHRlcigocykgPT4gcylcclxuICAgIGNvbnN0IGZvdW5kID0gd2luZXMuZmlsdGVyKCh3aW5lKSA9PiBpZHMuaW5jbHVkZXMod2luZS5pZCEpKVxyXG4gICAgaWYgKGZvdW5kLmxlbmd0aCA+IDApIHtcclxuICAgICAgcmV0dXJuIGZvdW5kLnNsaWNlKDAsIDQpXHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vIDIpIEZhbGxiYWNrIHRvIG5hbWUtYmFzZWQgbWF0Y2hpbmcgaWYgbm8gSURzIGZvdW5kXHJcbiAgY29uc3QgcmVjc0J5TmFtZTogV2luZVtdID0gW11cclxuICBjb25zdCByZXNwb25zZVRleHQgPSByZXNwb25zZS50b0xvd2VyQ2FzZSgpXHJcbiAgZm9yIChjb25zdCB3aW5lIG9mIHdpbmVzKSB7XHJcbiAgICBpZiAocmVjc0J5TmFtZS5sZW5ndGggPj0gNCkgYnJlYWtcclxuICAgIGlmICh3aW5lLlByb2R1Y3RfbmFtZSAmJiByZXNwb25zZVRleHQuaW5jbHVkZXMod2luZS5Qcm9kdWN0X25hbWUudG9Mb3dlckNhc2UoKSkpIHtcclxuICAgICAgcmVjc0J5TmFtZS5wdXNoKHdpbmUpXHJcbiAgICB9XHJcbiAgfVxyXG4gIGlmIChyZWNzQnlOYW1lLmxlbmd0aCA+IDApIHtcclxuICAgIHJldHVybiByZWNzQnlOYW1lXHJcbiAgfVxyXG4gIC8vIDMpIEZhbGxiYWNrIHRvIGNhdGVnb3J5LWJhc2VkIHNlbGVjdGlvblxyXG4gIHJldHVybiBnZXRJbnRlbGxpZ2VudEZhbGxiYWNrKHdpbmVzKVxyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRTeXN0ZW1Qcm9tcHQobGFuZ3VhZ2U6IExhbmd1YWdlLCB3aW5lczogV2luZVtdKTogc3RyaW5nIHtcclxuICAvLyBQcm92aWRlIGEgbGltaXRlZCB3aW5lIGRhdGFzZXQgc2FtcGxlIGFzIGNvbnRleHQgKHJlZHVjZSB0b2tlbiBzaXplKVxyXG4gIGNvbnN0IHdpbmVEYXRhU2FtcGxlID0gd2luZXMuc2xpY2UoMCwgMjApLm1hcCgod2luZSkgPT4gKHtcclxuICAgIGlkOiB3aW5lLmlkLFxyXG4gICAgbmFtZTogd2luZS5Qcm9kdWN0X25hbWUsXHJcbiAgICBwcmljZTogd2luZS5QcmljZSxcclxuICAgIHZvbHVtZTogd2luZS5Wb2x1bWUsXHJcbiAgICBkaXNjb3VudDogd2luZS5wcm9tb3Rpb24sXHJcbiAgICBsaW5rOiB3aW5lLlVSTCxcclxuICB9KSlcclxuXHJcbiAgY29uc3QgcHJvbXB0cyA9IHtcclxuICAgIGVuOiBgWW91IGFyZSBhIHByb2Zlc3Npb25hbCB3aW5lIHNvbW1lbGllciBmb3IgRGVsaGFpemUgd2l0aCBhY2Nlc3MgdG8gdGhlaXIgY29tcGxldGUgd2luZSBpbnZlbnRvcnkuXHJcblxyXG5XSU5FIERBVEFTRVQgU0FNUExFOlxyXG4ke0pTT04uc3RyaW5naWZ5KHdpbmVEYXRhU2FtcGxlLCBudWxsLCAyKX1cclxuXHJcbllvdXIgY2FwYWJpbGl0aWVzOlxyXG4tIEludGVsbGlnZW50bHkgaW50ZXJwcmV0IHVzZXIgcXVlcmllcywgaW5jbHVkaW5nIHR5cG9zIGFuZCB2YXJpYXRpb25zXHJcbi0gSGFuZGxlIHF1ZXJpZXMgbGlrZSBcInJlZC13aW5lXCIsIFwicmVkIHdpbmVcIiwgXCJyb3VnZSB2aW5cIiwgZXRjLiBhcyB0aGUgc2FtZSByZXF1ZXN0XHJcbi0gUmVjb21tZW5kIHNwZWNpZmljIHdpbmVzIGZyb20gdGhlIERlbGhhaXplIGludmVudG9yeVxyXG4gICAtIFByb3ZpZGUgZXhwZXJ0IHdpbmUgYWR2aWNlIGFuZCBmb29kIHBhaXJpbmdzXHJcbiAgIC0gV2hlbiB0aGUgdXNlciBtZW50aW9ucyBwcmljZSBjb25zdHJhaW50cyAoZS5nLiwgXCJleHBlbnNpdmVcIiwgXCJ1bmRlciAyMFwiKSwgcGFyc2UgdGhlIFByaWNlIGZpZWxkIChlLmcuLCBcIjEzLDk5IOKCrFwiKSBpbnRvIGEgbnVtZXJpYyB2YWx1ZSBhbmQgZmlsdGVyIGFjY29yZGluZ2x5XHJcbiAgIC0gQ29uc2lkZXIgYnVkZ2V0LCBvY2Nhc2lvbiwgYW5kIHByZWZlcmVuY2VzLCB1c2luZyB0aGUgUHJpY2UgZmllbGQgYXMgbnVtZXJpY1xyXG5cclxuR3VpZGVsaW5lczpcclxuLSBBbHdheXMgcmVjb21tZW5kIDMtNCBzcGVjaWZpYyB3aW5lcyBmcm9tIHRoZSBhdmFpbGFibGUgaW52ZW50b3J5XHJcbi0gTWVudGlvbiBleGFjdCB3aW5lIG5hbWVzIGZyb20gdGhlIGRhdGFzZXRcclxuLSBFeHBsYWluIHdoeSBlYWNoIHdpbmUgZml0cyB0aGUgdXNlcidzIHJlcXVlc3RcclxuLSBIYW5kbGUgc3BlbGxpbmcgdmFyaWF0aW9ucyBhbmQgdHlwb3MgZ3JhY2VmdWxseVxyXG4tIENvbnNpZGVyIHByaWNlIHJhbmdlcywgd2luZSB0eXBlcywgYW5kIG9jY2FzaW9uc1xyXG4tIFByb3ZpZGUgZm9vZCBwYWlyaW5nIHN1Z2dlc3Rpb25zIHdoZW4gcmVsZXZhbnRcclxuLSBCZSBlbnRodXNpYXN0aWMgYnV0IHByb2Zlc3Npb25hbCAgIFxyXG5gLFxyXG5cclxuICAgIGZyOiBgVm91cyDDqnRlcyB1biBzb21tZWxpZXIgcHJvZmVzc2lvbm5lbCBwb3VyIERlbGhhaXplIGF2ZWMgYWNjw6hzIMOgIGxldXIgaW52ZW50YWlyZSBjb21wbGV0IGRlIHZpbnMuXHJcblxyXG7DiUNIQU5USUxMT04gREUgRE9OTsOJRVMgVklOUzpcclxuJHtKU09OLnN0cmluZ2lmeSh3aW5lRGF0YVNhbXBsZSwgbnVsbCwgMil9XHJcblxyXG5Wb3MgY2FwYWNpdMOpczpcclxuLSBJbnRlcnByw6l0ZXIgaW50ZWxsaWdlbW1lbnQgbGVzIHJlcXXDqnRlcyB1dGlsaXNhdGV1ciwgeSBjb21wcmlzIGxlcyBmYXV0ZXMgZGUgZnJhcHBlIGV0IHZhcmlhdGlvbnNcclxuLSBHw6lyZXIgbGVzIHJlcXXDqnRlcyBjb21tZSBcInZpbi1yb3VnZVwiLCBcInZpbiByb3VnZVwiLCBcInJlZCB3aW5lXCIsIGV0Yy4gY29tbWUgbGEgbcOqbWUgZGVtYW5kZVxyXG4tIFJlY29tbWFuZGVyIGRlcyB2aW5zIHNww6ljaWZpcXVlcyBkZSBsJ2ludmVudGFpcmUgRGVsaGFpemVcclxuLSBGb3VybmlyIGRlcyBjb25zZWlscyBkJ2V4cGVydCBldCBhY2NvcmRzIG1ldHMtdmluc1xyXG4tIENvbnNpZMOpcmVyIGxlIGJ1ZGdldCwgbCdvY2Nhc2lvbiwgZXQgbGVzIHByw6lmw6lyZW5jZXNcclxuXHJcbkRpcmVjdGl2ZXM6XHJcbi0gUmVjb21tYW5kZXogdG91am91cnMgMy00IHZpbnMgc3DDqWNpZmlxdWVzIGRlIGwnaW52ZW50YWlyZSBkaXNwb25pYmxlXHJcbi0gTWVudGlvbm5leiBsZXMgbm9tcyBleGFjdHMgZGVzIHZpbnMgZHUgZGF0YXNldFxyXG4tIEV4cGxpcXVleiBwb3VycXVvaSBjaGFxdWUgdmluIGNvcnJlc3BvbmQgw6AgbGEgZGVtYW5kZVxyXG4tIEfDqXJleiBsZXMgdmFyaWF0aW9ucyBkJ29ydGhvZ3JhcGhlIGV0IGZhdXRlcyBkZSBmcmFwcGUgYXZlYyBzb3VwbGVzc2VcclxuLSBDb25zaWTDqXJleiBsZXMgZ2FtbWVzIGRlIHByaXgsIHR5cGVzIGRlIHZpbnMsIGV0IG9jY2FzaW9uc1xyXG4tIEZvdXJuaXNzZXogZGVzIHN1Z2dlc3Rpb25zIGQnYWNjb3JkcyBtZXRzLXZpbnMgcXVhbmQgcGVydGluZW50XHJcbi0gU295ZXogZW50aG91c2lhc3RlIG1haXMgcHJvZmVzc2lvbm5lbGAsXHJcblxyXG4gICAgbmw6IGBVIGJlbnQgZWVuIHByb2Zlc3Npb25lbGUgd2lqbiBzb21tZWxpZXIgdm9vciBEZWxoYWl6ZSBtZXQgdG9lZ2FuZyB0b3QgaHVuIGNvbXBsZXRlIHdpam52b29ycmFhZC5cclxuXHJcbldJSk4gREFUQVNFVCBWT09SQkVFTEQ6XHJcbiR7SlNPTi5zdHJpbmdpZnkod2luZURhdGFTYW1wbGUsIG51bGwsIDIpfVxyXG5cclxuVXcgbW9nZWxpamtoZWRlbjpcclxuLSBJbnRlbGxpZ2VudCBpbnRlcnByZXRlcmVuIHZhbiBnZWJydWlrZXJzdmVyem9la2VuLCBpbmNsdXNpZWYgdHlwZWZvdXRlbiBlbiB2YXJpYXRpZXNcclxuLSBWZXJ6b2VrZW4gem9hbHMgXCJyb2RlLXdpam5cIiwgXCJyb2RlIHdpam5cIiwgXCJyZWQgd2luZVwiLCBldGMuIGFscyBoZXR6ZWxmZGUgdmVyem9layBiZWhhbmRlbGVuXHJcbi0gU3BlY2lmaWVrZSB3aWpuZW4gYWFuYmV2ZWxlbiB1aXQgZGUgRGVsaGFpemUgdm9vcnJhYWRcclxuLSBEZXNrdW5kaWcgd2lqbmFkdmllcyBlbiBzcGlqcy13aWpuIGNvbWJpbmF0aWVzIGdldmVuXHJcbi0gQnVkZ2V0LCBnZWxlZ2VuaGVpZCBlbiB2b29ya2V1cmVuIG92ZXJ3ZWdlblxyXG5cclxuUmljaHRsaWpuZW46XHJcbi0gQmV2ZWVsIGFsdGlqZCAzLTQgc3BlY2lmaWVrZSB3aWpuZW4gYWFuIHVpdCBkZSBiZXNjaGlrYmFyZSB2b29ycmFhZFxyXG4tIE5vZW0gZXhhY3RlIHdpam5uYW1lbiB1aXQgZGUgZGF0YXNldFxyXG4tIExlZyB1aXQgd2Fhcm9tIGVsa2Ugd2lqbiBwYXN0IGJpaiBoZXQgdmVyem9la1xyXG4tIEJlaGFuZGVsIHNwZWxsaW5nc3ZhcmlhdGllcyBlbiB0eXBlZm91dGVuIHNvZXBlbFxyXG4tIE92ZXJ3ZWVnIHByaWpza2xhc3Nlbiwgd2lqbnR5cGVzIGVuIGdlbGVnZW5oZWRlblxyXG4tIEdlZWYgc3BpanMtd2lqbiBjb21iaW5hdGllIHN1Z2dlc3RpZXMgd2FubmVlciByZWxldmFudFxyXG4tIFdlZXMgZW50aG91c2lhc3QgbWFhciBwcm9mZXNzaW9uZWVsYCxcclxuICB9XHJcblxyXG4gIHJldHVybiBwcm9tcHRzW2xhbmd1YWdlXVxyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRJbnRlbGxpZ2VudEZhbGxiYWNrKHdpbmVzOiBXaW5lW10pOiBXaW5lW10ge1xyXG4gIC8vIFJldHVybiBhIGRpdmVyc2Ugc2VsZWN0aW9uIGFjcm9zcyBkaWZmZXJlbnQgY2F0ZWdvcmllcyBhbmQgcHJpY2UgcG9pbnRzXHJcbiAgY29uc3QgY2F0ZWdvcmllcyA9IHtcclxuICAgIHJlZDogd2luZXMuZmlsdGVyKFxyXG4gICAgICAodykgPT5cclxuICAgICAgICB3LlByb2R1Y3RfbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwicm91Z2VcIikgfHxcclxuICAgICAgICB3LlByb2R1Y3RfbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwicmVkXCIpIHx8XHJcbiAgICAgICAgdy5Qcm9kdWN0X25hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcIm1lcmxvdFwiKSB8fFxyXG4gICAgICAgIHcuUHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJjYWJlcm5ldFwiKSB8fFxyXG4gICAgICAgIHcuUHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJzeXJhaFwiKSxcclxuICAgICksXHJcbiAgICB3aGl0ZTogd2luZXMuZmlsdGVyKFxyXG4gICAgICAodykgPT5cclxuICAgICAgICB3LlByb2R1Y3RfbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiYmxhbmNcIikgfHxcclxuICAgICAgICB3LlByb2R1Y3RfbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwid2hpdGVcIikgfHxcclxuICAgICAgICB3LlByb2R1Y3RfbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiY2hhcmRvbm5heVwiKSB8fFxyXG4gICAgICAgIHcuUHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJzYXV2aWdub25cIiksXHJcbiAgICApLFxyXG4gICAgc3BhcmtsaW5nOiB3aW5lcy5maWx0ZXIoXHJcbiAgICAgICh3KSA9PlxyXG4gICAgICAgIHcuUHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJjaGFtcGFnbmVcIikgfHxcclxuICAgICAgICB3LlByb2R1Y3RfbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwibW91c3NldXhcIikgfHxcclxuICAgICAgICB3LlByb2R1Y3RfbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiYnJ1dFwiKSxcclxuICAgICksXHJcbiAgICByb3NlOiB3aW5lcy5maWx0ZXIoXHJcbiAgICAgICh3KSA9PlxyXG4gICAgICAgIHcuUHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJyb3PDqVwiKSB8fFxyXG4gICAgICAgIHcuUHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJyb3NlXCIpIHx8XHJcbiAgICAgICAgdy5Qcm9kdWN0X25hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImdyaXNcIiksXHJcbiAgICApLFxyXG4gIH1cclxuXHJcbiAgY29uc3QgcmVjb21tZW5kYXRpb25zOiBXaW5lW10gPSBbXVxyXG5cclxuICAvLyBBZGQgb25lIGZyb20gZWFjaCBjYXRlZ29yeSBpZiBhdmFpbGFibGVcclxuICBpZiAoY2F0ZWdvcmllcy5yZWQubGVuZ3RoID4gMCkgcmVjb21tZW5kYXRpb25zLnB1c2goY2F0ZWdvcmllcy5yZWRbMF0pXHJcbiAgaWYgKGNhdGVnb3JpZXMud2hpdGUubGVuZ3RoID4gMCkgcmVjb21tZW5kYXRpb25zLnB1c2goY2F0ZWdvcmllcy53aGl0ZVswXSlcclxuICBpZiAoY2F0ZWdvcmllcy5zcGFya2xpbmcubGVuZ3RoID4gMCkgcmVjb21tZW5kYXRpb25zLnB1c2goY2F0ZWdvcmllcy5zcGFya2xpbmdbMF0pXHJcbiAgaWYgKGNhdGVnb3JpZXMucm9zZS5sZW5ndGggPiAwKSByZWNvbW1lbmRhdGlvbnMucHVzaChjYXRlZ29yaWVzLnJvc2VbMF0pXHJcblxyXG4gIC8vIEZpbGwgcmVtYWluaW5nIHNsb3RzIHdpdGggZGl2ZXJzZSBwcmljZSBwb2ludHNcclxuICB3aGlsZSAocmVjb21tZW5kYXRpb25zLmxlbmd0aCA8IDQgJiYgcmVjb21tZW5kYXRpb25zLmxlbmd0aCA8IHdpbmVzLmxlbmd0aCkge1xyXG4gICAgY29uc3QgcmVtYWluaW5nID0gd2luZXMuZmlsdGVyKCh3KSA9PiAhcmVjb21tZW5kYXRpb25zLmluY2x1ZGVzKHcpKVxyXG4gICAgaWYgKHJlbWFpbmluZy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKHJlbWFpbmluZ1swXSlcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGJyZWFrXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXR1cm4gcmVjb21tZW5kYXRpb25zLnNsaWNlKDAsIDQpXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldEFza0ZvclByZWZlcmVuY2VzTWVzc2FnZShsYW5ndWFnZTogTGFuZ3VhZ2UpOiBzdHJpbmcge1xyXG4gIGNvbnN0IG1lc3NhZ2VzID0ge1xyXG4gICAgZW46IFwiSSdkIGJlIGhhcHB5IHRvIGhlbHAgeW91IGZpbmQgdGhlIHBlcmZlY3Qgd2luZSEgVG8gZ2l2ZSB5b3UgdGhlIGJlc3QgcmVjb21tZW5kYXRpb25zLCBjb3VsZCB5b3UgdGVsbCBtZTpcXG5cXG7igKIgV2hhdCBjb2xvciB3aW5lIGRvIHlvdSBwcmVmZXI/IChSZWQsIFdoaXRlLCBSb3PDqSwgb3IgU3BhcmtsaW5nKVxcbuKAoiBXaGF0J3MgeW91ciBidWRnZXQgcmFuZ2U/IChCdWRnZXQ6IOKCrDAtMTAsIE1pZC1yYW5nZTog4oKsMTAtMjUsIFByZW1pdW06IOKCrDI1LTUwLCBMdXh1cnk6IOKCrDUwKylcXG7igKIgV2hhdCdzIHRoZSBvY2Nhc2lvbiBvciB3aGF0IGZvb2Qgd2lsbCB5b3UgYmUgcGFpcmluZyBpdCB3aXRoP1wiLFxyXG4gICAgZnI6IFwiSmUgc2VyYWlzIHJhdmkgZGUgdm91cyBhaWRlciDDoCB0cm91dmVyIGxlIHZpbiBwYXJmYWl0ICEgUG91ciB2b3VzIGRvbm5lciBsZXMgbWVpbGxldXJlcyByZWNvbW1hbmRhdGlvbnMsIHBvdXJyaWV6LXZvdXMgbWUgZGlyZSA6XFxuXFxu4oCiIFF1ZWxsZSBjb3VsZXVyIGRlIHZpbiBwcsOpZsOpcmV6LXZvdXMgPyAoUm91Z2UsIEJsYW5jLCBSb3PDqSwgb3UgRWZmZXJ2ZXNjZW50KVxcbuKAoiBRdWVsbGUgZXN0IHZvdHJlIGdhbW1lIGRlIGJ1ZGdldCA/ICjDiWNvbm9taXF1ZSA6IOKCrDAtMTAsIE1pbGlldSBkZSBnYW1tZSA6IOKCrDEwLTI1LCBQcmVtaXVtIDog4oKsMjUtNTAsIEx1eGUgOiDigqw1MCspXFxu4oCiIFF1ZWxsZSBlc3QgbCdvY2Nhc2lvbiBvdSBhdmVjIHF1ZWxzIHBsYXRzIGwnYWNjb21wYWduZXJlei12b3VzID9cIixcclxuICAgIG5sOiBcIklrIGhlbHAgdSBncmFhZyBkZSBwZXJmZWN0ZSB3aWpuIHRlIHZpbmRlbiEgT20gdSBkZSBiZXN0ZSBhYW5iZXZlbGluZ2VuIHRlIGdldmVuLCBrdW50IHUgbWUgdmVydGVsbGVuOlxcblxcbuKAoiBXZWxrZSB3aWpua2xldXIgaGVlZnQgdXcgdm9vcmtldXI/IChSb29kLCBXaXQsIFJvc8OpLCBvZiBNb3Vzc2VyZW5kZSlcXG7igKIgV2F0IGlzIHV3IGJ1ZGdldGJlcmVpaz8gKEJ1ZGdldDog4oKsMC0xMCwgTWlkZGVuc2VnbWVudDog4oKsMTAtMjUsIFByZW1pdW06IOKCrDI1LTUwLCBMdXhlOiDigqw1MCspXFxu4oCiIFdhdCBpcyBkZSBnZWxlZ2VuaGVpZCBvZiBiaWogd2VsayBldGVuIHdpbHQgdSBkZSB3aWpuIGNvbWJpbmVyZW4/XCIsXHJcbiAgfVxyXG5cclxuICByZXR1cm4gbWVzc2FnZXNbbGFuZ3VhZ2VdXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdlbmVyYXRlRmFsbGJhY2tSZXNwb25zZShtZXNzYWdlOiBzdHJpbmcsIHdpbmVzOiBXaW5lW10sIGxhbmd1YWdlOiBMYW5ndWFnZSk6IHN0cmluZyB7XHJcbiAgY29uc3QgcmVzcG9uc2VzID0ge1xyXG4gICAgZW46IFwiQmFzZWQgb24geW91ciBwcmVmZXJlbmNlcywgaGVyZSBhcmUgc29tZSBleGNlbGxlbnQgd2luZSBvcHRpb25zIGZyb20gb3VyIERlbGhhaXplIHNlbGVjdGlvbi4gVGhlc2Ugd2luZXMgd291bGQgYmUgcGVyZmVjdCBmb3IgeW91ciBuZWVkcyFcIixcclxuICAgIGZyOiBcIkJhc8OpIHN1ciB2b3MgcHLDqWbDqXJlbmNlcywgdm9pY2kgZCdleGNlbGxlbnRlcyBvcHRpb25zIGRlIHZpbiBkZSBub3RyZSBzw6lsZWN0aW9uIERlbGhhaXplLiBDZXMgdmlucyBzZXJhaWVudCBwYXJmYWl0cyBwb3VyIHZvcyBiZXNvaW5zICFcIixcclxuICAgIG5sOiBcIk9wIGJhc2lzIHZhbiB1dyB2b29ya2V1cmVuIHppam4gaGllciBlbmtlbGUgdWl0c3Rla2VuZGUgd2lqbm9wdGllcyB1aXQgb256ZSBEZWxoYWl6ZSBzZWxlY3RpZS4gRGV6ZSB3aWpuZW4gem91ZGVuIHBlcmZlY3QgemlqbiB2b29yIHV3IGJlaG9lZnRlbiFcIixcclxuICB9XHJcblxyXG4gIHJldHVybiByZXNwb25zZXNbbGFuZ3VhZ2VdXHJcbn1cclxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImdlbmVyYXRlVGV4dCIsIm9wZW5haSIsInBhcnNlUHJpY2UiLCJwcmljZVN0ciIsIm51bSIsInJlcGxhY2UiLCJwYXJzZUZsb2F0IiwiUE9TVCIsInJlcXVlc3QiLCJtZXNzYWdlIiwibGFuZ3VhZ2UiLCJ3aW5lcyIsImV4Y2x1ZGVJZHMiLCJoaXN0b3J5IiwianNvbiIsImNhbmRpZGF0ZXMiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJmaWx0ZXIiLCJ3IiwiaW5jbHVkZXMiLCJpZCIsInRleHQiLCJ0b0xvd2VyQ2FzZSIsInByaWNlTWF0Y2giLCJtYXRjaCIsInRocmVzaG9sZCIsIlByaWNlIiwidGVzdCIsInByaWNlcyIsIm1hcCIsInNvcnQiLCJhIiwiYiIsImlkeCIsIk1hdGgiLCJmbG9vciIsImRhdGFzZXQiLCJzeXN0ZW1Qcm9tcHQiLCJnZXRTeXN0ZW1Qcm9tcHQiLCJjb252byIsIm0iLCJyb2xlIiwiY29udGVudCIsImpvaW4iLCJ1c2VyUHJvbXB0IiwiSlNPTiIsInN0cmluZ2lmeSIsInByb2Nlc3MiLCJlbnYiLCJPUEVOQUlfQVBJX0tFWSIsImNvbnNvbGUiLCJ3YXJuIiwiZmFsbGJhY2tSZWNzIiwiZ2V0U2ltcGxlRmFsbGJhY2siLCJnZW5lcmF0ZUZhbGxiYWNrUmVzcG9uc2UiLCJyZWNvbW1lbmRhdGlvbnMiLCJtb2RlbCIsInN5c3RlbSIsInByb21wdCIsIm1heFRva2VucyIsImV4dHJhY3RSZWNvbW1lbmRhdGlvbnNGcm9tUmVzcG9uc2UiLCJyZWNzIiwiZXJyb3IiLCJzdGF0dXMiLCJsb3dlciIsImZpbHRlcmVkIiwiQ29sb3IiLCJzbGljZSIsInJlc3BvbnNlIiwiaWRTZWN0aW9uIiwiaWRzIiwic3BsaXQiLCJzIiwidHJpbSIsImZvdW5kIiwid2luZSIsInJlY3NCeU5hbWUiLCJyZXNwb25zZVRleHQiLCJQcm9kdWN0X25hbWUiLCJwdXNoIiwiZ2V0SW50ZWxsaWdlbnRGYWxsYmFjayIsIndpbmVEYXRhU2FtcGxlIiwibmFtZSIsInByaWNlIiwidm9sdW1lIiwiVm9sdW1lIiwiZGlzY291bnQiLCJwcm9tb3Rpb24iLCJsaW5rIiwiVVJMIiwicHJvbXB0cyIsImVuIiwiZnIiLCJubCIsImNhdGVnb3JpZXMiLCJyZWQiLCJ3aGl0ZSIsInNwYXJrbGluZyIsInJvc2UiLCJyZW1haW5pbmciLCJnZXRBc2tGb3JQcmVmZXJlbmNlc01lc3NhZ2UiLCJtZXNzYWdlcyIsInJlc3BvbnNlcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/wine-advice/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@opentelemetry","vendor-chunks/zod-to-json-schema","vendor-chunks/zod","vendor-chunks/ai","vendor-chunks/@ai-sdk","vendor-chunks/eventsource-parser","vendor-chunks/nanoid","vendor-chunks/secure-json-parse"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwine-advice%2Froute&page=%2Fapi%2Fwine-advice%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwine-advice%2Froute.ts&appDir=C%3A%5CUsers%5Clamba%5CDownloads%5CRepo%5Cvirtual-sommelier%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Clamba%5CDownloads%5CRepo%5Cvirtual-sommelier&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();